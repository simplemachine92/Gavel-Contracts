// SPDX-License-Identifier: UNLICENSED
pragma solidity ^0.8.13;

import "forge-std/Test.sol";
import "../src/Liqqer.sol";

contract LiqqerTest is Test {
    uint256 MAX_INT = 2**256 - 1;
    event cover(uint256);
    event bal(uint256);

    Liqqer public liqqer;

    ILiqqProvider private immutable DPROV =
        ILiqqProvider(0xA67BdecB3FB056F314Dcc76F3ACd3B3F936C52ca);

    address public me = 0x00000000000E898D039D41D5aB37738F3aeD833D;

    function setUp() public {
        vm.prank(0x039cDF7e3ad43816DAb9610a6A2cB2D05114406d);
        liqqer = new Liqqer(address(me));
    }

    function testflashLoan() public {
        address collateralA = 0xae7ab96520DE3A18E5e111B5EaAb095312D7fE84;
        address debtA = 0xC18360217D8F7Ab5e7c516566761Ea12Ce7F9D72;
        address user = 0x808EF4011e030BAd065cd4C437ebA3DD34B941e4;

        /* 
        swaps: [
    {
      sellToken: '0xae7ab96520DE3A18E5e111B5EaAb095312D7fE84',
      buyToken: '0xC18360217D8F7Ab5e7c516566761Ea12Ce7F9D72',
      allowanceTarget: '0xdef1c0ded9bec7f1a1670819833240f027b25eff',
      to: '0xdef1c0ded9bec7f1a1670819833240f027b25eff',
      data: '0x415565b0000000000000000000000000ae7ab96520de3a18e5e111b5eaab095312d7fe84000000000000000000000000c18360217d8f7ab5e7c516566761ea12ce7f9d72000000000000000000000000000000000000000000000000018501e03847dc80000000000000000000000000000000000000000000000000a534d18a8f6cfb0f00000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000003e00000000000000000000000000000000000000000000000000000000000000780000000000000000000000000000000000000000000000000000000000000001a0000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000032000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ae7ab96520de3a18e5e111b5eaab095312d7fe84000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc2000000000000000000000000000000000000000000000000000000000000014000000000000000000000000000000000000000000000000000000000000002e000000000000000000000000000000000000000000000000000000000000002e000000000000000000000000000000000000000000000000000000000000002a0000000000000000000000000000000000000000000000000018501e03847dc80000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002e0000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000143757276650000000000000000000000000000000000000000000000000000000000000000000000018501e03847dc80000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000080000000000000000000000000dc24316b9ae028f1497c275eb9192a3ea0f670223df021240000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001a0000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000034000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc2000000000000000000000000c18360217d8f7ab5e7c516566761ea12ce7f9d7200000000000000000000000000000000000000000000000000000000000001400000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002c0ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000002556e6973776170563200000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff000000000000000000000000000000000000000000000000a534d18a8f6cfb0e000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000f164fc0ec4e93095b804a4795bbe1e041497b92a00000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000002000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc2000000000000000000000000c18360217d8f7ab5e7c516566761ea12ce7f9d72000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001c000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000c00000000000000000000000000000000000000000000000000000000000000003000000000000000000000000ae7ab96520de3a18e5e111b5eaab095312d7fe84000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc2000000000000000000000000eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee0000000000000000000000000000000000000000000000000000000000000000869584cd000000000000000000000000100000000000000000000000000000000000001100000000000000000000000000000000000000000000008b9763d16f63ca32e7',
      isDebtSwap: false
    }
  ],
  collatToken: '0xae7ab96520DE3A18E5e111B5EaAb095312D7fE84',
  debtToken: '0xC18360217D8F7Ab5e7c516566761Ea12Ce7F9D72',
  user: '0x808EF4011e030BAd065cd4C437ebA3DD34B941e4',
  receiveAToken: false,
  loanAmountForCall: BigNumber { _hex: '0x9cb4aaef42ff347d', _isBigNumber: true }
}

         */

        ILiqqer.ZeroSwap[] memory swaps = new ILiqqer.ZeroSwap[](1);

        swaps[0] = ILiqqer.ZeroSwap({
            allowTarget: address(0xDef1C0ded9bec7F1a1670819833240f027b25EfF),
            swapTarget: payable(0xDef1C0ded9bec7F1a1670819833240f027b25EfF),
            callData: hex"415565b0000000000000000000000000ae7ab96520de3a18e5e111b5eaab095312d7fe84000000000000000000000000c18360217d8f7ab5e7c516566761ea12ce7f9d72000000000000000000000000000000000000000000000000018501e03847dc80000000000000000000000000000000000000000000000000a534d18a8f6cfb0f00000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000003e00000000000000000000000000000000000000000000000000000000000000780000000000000000000000000000000000000000000000000000000000000001a0000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000032000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ae7ab96520de3a18e5e111b5eaab095312d7fe84000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc2000000000000000000000000000000000000000000000000000000000000014000000000000000000000000000000000000000000000000000000000000002e000000000000000000000000000000000000000000000000000000000000002e000000000000000000000000000000000000000000000000000000000000002a0000000000000000000000000000000000000000000000000018501e03847dc80000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002e0000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000143757276650000000000000000000000000000000000000000000000000000000000000000000000018501e03847dc80000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000080000000000000000000000000dc24316b9ae028f1497c275eb9192a3ea0f670223df021240000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001a0000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000034000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc2000000000000000000000000c18360217d8f7ab5e7c516566761ea12ce7f9d7200000000000000000000000000000000000000000000000000000000000001400000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002c0ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000002556e6973776170563200000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff000000000000000000000000000000000000000000000000a534d18a8f6cfb0e000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000f164fc0ec4e93095b804a4795bbe1e041497b92a00000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000002000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc2000000000000000000000000c18360217d8f7ab5e7c516566761ea12ce7f9d72000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001c000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000c00000000000000000000000000000000000000000000000000000000000000003000000000000000000000000ae7ab96520de3a18e5e111b5eaab095312d7fe84000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc2000000000000000000000000eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee0000000000000000000000000000000000000000000000000000000000000000869584cd000000000000000000000000100000000000000000000000000000000000001100000000000000000000000000000000000000000000008b9763d16f63ca32e7",
            isDebtSwap: false
        });

        ILiqqer.CallParams memory params;
        params = ILiqqer.CallParams({
            collatA: collateralA,
            debtA: debtA,
            userA: user,
            debtToCover: 11291838110322603133,
            collatToReceive: 1,
            swaps: swaps
        });

        vm.prank(me);
        liqqer.flash_WaC(params);
    }
}
